(function(t){function e(e){for(var r,i,o=e[0],c=e[1],l=e[2],p=0,u=[];p<o.length;p++)i=o[p],Object.prototype.hasOwnProperty.call(s,i)&&s[i]&&u.push(s[i][0]),s[i]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(t[r]=c[r]);d&&d(e);while(u.length)u.shift()();return n.push.apply(n,l||[]),a()}function a(){for(var t,e=0;e<n.length;e++){for(var a=n[e],r=!0,o=1;o<a.length;o++){var c=a[o];0!==s[c]&&(r=!1)}r&&(n.splice(e--,1),t=i(i.s=a[0]))}return t}var r={},s={app:0},n=[];function i(e){if(r[e])return r[e].exports;var a=r[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,i),a.l=!0,a.exports}i.m=t,i.c=r,i.d=function(t,e,a){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(i.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)i.d(a,r,function(e){return t[e]}.bind(null,r));return a},i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="/maskMap/dist/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],c=o.push.bind(o);o.push=e,o=o.slice();for(var l=0;l<o.length;l++)e(o[l]);var d=c;n.push([0,"chunk-vendors"]),a()})({0:function(t,e,a){t.exports=a("56d7")},"0685":function(t,e,a){"use strict";var r=a("4c25"),s=a.n(r);s.a},"4c25":function(t,e,a){},"56d7":function(t,e,a){"use strict";a.r(e);a("e260"),a("e6cf"),a("cca6"),a("a79d");var r=a("2b0e"),s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"app"}},[a("div",{staticClass:"bg-secondary py-1 d-flex justify-content-between px-2"},[a("div",{staticClass:"h3 mb-0 text-white",staticStyle:{"line-height":"68px"}},[t._v(" 口罩地圖 ")]),a("div",{staticStyle:{"line-height":"68px"}},[a("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal.modal-lg",modifiers:{"modal-lg":!0}}],staticClass:"mr-1",staticStyle:{"border-color":"#fff","border-width":"2px"}},[a("div",[a("i",{staticClass:"far fa-question-circle fa-1x"})])]),a("b-modal",{attrs:{id:"modal-lg",size:"md",title:"購買規定 (2020/02/18)","hide-footer":""}},[a("div",{staticClass:"text-center"},[a("img",{attrs:{src:"https://imgur.dcard.tw/CPYUzS1.jpg",alt:"",srcset:"",width:"70%",height:"50%"}}),a("p",{staticClass:"text-info"},[a("a",{attrs:{href:"https://www.cdc.gov.tw/Bulletin/Detail/wycLegOplsUwGsH6_SPAXg?typeid=9",target:"_blank"}},[t._v(" 資料來源:衛生福利部疾病管制署 ")])]),a("p",{staticClass:"text-success my-1"},[t._v("藥局顯示為淺綠色, 表示還有足量庫存")]),a("div",[a("span",[a("img",{attrs:{src:"https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-green.png",alt:"",srcset:""}}),t._v(" 貨源充足 ")]),a("span",[a("img",{attrs:{src:"https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-red.png",alt:"",srcset:""}}),t._v(" 貨源不足 ")]),a("span",[a("img",{attrs:{src:"https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-grey.png",alt:"",srcset:""}}),t._v(" 已經沒貨 ")])])])])],1)]),a("div",{staticClass:"row no-gutters"},[a("div",{staticClass:"col-md-3 toolbox"},[a("div",{staticClass:"sticky-top shadow-sm p-2"},[a("div",{staticClass:"citySelect"},[a("select",{directives:[{name:"model",rawName:"v-model",value:t.select.filter,expression:"select.filter"}],staticClass:"custom-select custom-select-md mb-3",on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.select,"filter",e.target.multiple?a:a[0])}}},[a("option",{attrs:{selected:""}},[t._v("Open this select menu")]),t._l(t.cityFilter,(function(e,r){return a("option",{key:r,domProps:{value:e}},[t._v(t._s(e))])}))],2)]),a("div",{staticClass:"TownSelect"},[a("select",{directives:[{name:"model",rawName:"v-model",value:t.select.filter2,expression:"select.filter2"}],staticClass:"custom-select custom-select-md mb-3",on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.select,"filter2",e.target.multiple?a:a[0])}}},t._l(t.townFilter,(function(e,r){return a("option",{key:r,domProps:{value:e}},[t._v(" "+t._s(e)+" ")])})),0)]),a("div",{staticClass:"input-group mb-3"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.inputAddress,expression:"inputAddress"}],staticClass:"form-control",attrs:{type:"text",placeholder:"請輸入欲查詢的縣市和區域","aria-describedby":"button-addon2"},domProps:{value:t.inputAddress},on:{input:function(e){e.target.composing||(t.inputAddress=e.target.value)}}}),a("div",{staticClass:"input-group-append"},[a("button",{staticClass:"btn btn-outline-secondary btn-sm",attrs:{type:"button",id:"button-addon2"},on:{click:t.filterAddress}},[t._m(0)])])]),a("div",{staticClass:"mr-1 text-sm-center text-muted"},[t._v("總共找到"),a("span",[t._v(t._s(t.filterData.length))]),t._v("家相符的藥局")])]),a("div",{staticClass:"cardGroup"},t._l(t.filterData,(function(e,r){return a("Card",{key:r,attrs:{store:e},on:{switchcard:t.switchGeo,switchshare:t.switchNote}})})),1)]),a("loading",{attrs:{active:t.isLoading},on:{"update:active":function(e){t.isLoading=e}}},[a("div",{staticClass:"col-md-9"},[t.status.fileUploading?a("i",{staticClass:"fas fa-sync fa-spin fa-3x"}):t._e()])]),a("b-modal",{ref:"my-modal",attrs:{"hide-footer":"",title:"備註","header-bg-variant":"info","header-text-variant":"white"}},[a("div",{staticClass:"d-block text-left"},[a("p",[t._v(t._s(t.noteMessage))])])]),t._m(1)],1)])},n=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("i",{staticClass:"fas fa-search"})])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"col-md-9"},[a("div",{attrs:{id:"map"}})])}],i=(a("99af"),a("4de4"),a("7db0"),a("c740"),a("4160"),a("caad"),a("c975"),a("d81d"),a("a434"),a("b0c0"),a("2532"),a("159b"),a("5530")),o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"card mt-2",on:{click:t.setFocus}},[a("div",{staticClass:"card-body",class:t.store.properties.mask_adult>30?"hightlight":"normal"},[a("div",{staticClass:"d-flex align-items-end"},[a("h4",{staticClass:"card-title mt-3"},[t._v(t._s(t.store.properties.name)+" "),t.store.properties.note.length>1?a("button",{staticClass:"small text-white bg-danger",attrs:{type:"button",id:"toggleModal"},on:{click:t.clickHandler}},[t._v(" 註 ")]):t._e()])]),a("p",[a("i",{staticClass:"fas fa-home mr-2"}),a("a",{attrs:{href:t.getHref(t.store.properties.address),target:"_blank"}},[t._v(t._s(t.store.properties.address))])]),a("p",[a("i",{staticClass:"fas fa-phone mr-2 mt-1"}),a("a",{attrs:{href:"tel:+886-${store.properties.phone}"}},[t._v(t._s(t.store.properties.phone))])]),a("small",{staticClass:"card-text d-none d-lg-block"},[t._v("最後更新時間: "+t._s(t.store.properties.updated))])])]),a("div",{staticClass:"bottom pt-1 pb-1"},[a("i",{staticClass:"fas fa-share-alt mt-1 d-none d-lg-block"}),a("p",{staticClass:"card-text"},[t._v("成人口罩: "+t._s(t.store.properties.mask_adult)+" | 兒童口罩: "+t._s(t.store.properties.mask_child))])])])},c=[],l={name:"Card",props:["store"],template:"<h3>{{ store }}</h3>",methods:{getHref:function(t){return"https://www.google.com.tw/maps/place/".concat(t)},setFocus:function(){this.$emit("switchcard",this.store)},clickHandler:function(){this.$emit("switchshare",this.store)}}},d=l,p=(a("0685"),a("2877")),u=Object(p["a"])(d,o,c,!1,null,"52638bec",null),f=u.exports,m=a("e11e"),h=a.n(m),g=(a("6cc5"),a("2573"),{}),v={iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]},b={green:new h.a.Icon(Object(i["a"])({iconUrl:"https://cdn.rawgit.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-green.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png"},v)),grey:new h.a.Icon(Object(i["a"])({iconUrl:"https://cdn.rawgit.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-grey.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png"},v)),red:new h.a.Icon(Object(i["a"])({iconUrl:"https://cdn.rawgit.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-red.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png"},v))},y={name:"App",data:function(){return{dataAry:[],city:[],cityFilter:[],newAry:[],town:[],townFilter:[],geoInfo:[],markers:[],inputAddress:"",noteMessage:"",isLoading:!0,select:{filter:"新北市",filter2:"新店區"},status:{fileUploading:!0},iconData:b}},methods:{initialMap:function(){g=h.a.map("map",{center:[24.956111,121.5365],zoom:18}),h.a.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'Map data ©<a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>|Created by <a href="https://github.com/fan630?tab=repositories" target="_blank">fan630</a>',maxZoom:19}).addTo(g)},getUser:function(){if("geolocation"in navigator){var t=function(t){var e=t.coords.longitude,a=t.coords.latitude;console.log("longitude: ".concat(e," | latitude: ").concat(a))};navigator.geolocation.getCurrentPosition(t)}else console.log("geolocation IS NOT available on your browser")},switchGeo:function(t){var e=t.geometry.coordinates[1],a=t.geometry.coordinates[0];g.flyTo(new h.a.LatLng(e,a)),h.a.marker([e,a]).addTo(g).bindPopup("<h4>".concat(t.properties.name,"</h4>\n               <p>\n                  成人口罩:<mark>").concat(t.properties.mask_adult,"</mark><br>\n                  兒童口罩:").concat(t.properties.mask_child,'<br>\n                  診所電話:\n                  <a href="tel:+886-').concat(t.properties.phone,'">').concat(t.properties.phone,"</a>\n               </p>")).openPopup()},switchNote:function(t){var e=this;e.noteMessage=t.properties.note,e.$refs["my-modal"].toggle("#toggle-btn")},filterColor:function(t){switch(!0){case t>=10:return this.iconData.green;case t<10&&t>0:return this.iconData.red;case 0==t:return this.iconData.grey}},dataCreated:function(){this.status.fileUploading=!0,this.isLoading=!0;for(var t=(new h.a.MarkerClusterGroup).addTo(g),e=0;e<this.geoInfo.length;e++)this.status.fileUploading=!1,this.isLoading=!1,t.addLayer(h.a.marker([this.geoInfo[e].lng,this.geoInfo[e].lat],{icon:this.filterColor(this.geoInfo[e].adult)}).bindPopup("<h3>".concat(this.geoInfo[e].name,"</h3>\n                              <p>\n                                成人口罩:").concat(this.geoInfo[e].adult,"  \n                                兒童口罩:").concat(this.geoInfo[e].child,"\n                                診所電話:").concat(this.geoInfo[e].phone,"\n                              </p>")));g.addLayer(t)},filterAddress:function(){var t=this;return this.newAry.length=0,this.dataAry.filter((function(e){e.properties.address.includes(t.inputAddress)&&(t.select.filter="",t.select.filter2="",t.newAry.push(e))}))}},computed:{filterData:function(){var t=this;return"Open this select menu"===t.select.filter?t.dataAry:""===this.select.filter&&""===this.select.filter2?t.newAry:(t.town.length=0,t.dataAry.find((function(e){t.select.filter===e.properties.county&&t.town.push(e.properties.town)})),t.townFilter=t.town.filter((function(e,a,r){return t.town.indexOf(e)===a})),t.dataAry.filter((function(e){return e.properties.county===t.select.filter&&e.properties.town==t.select.filter2})))}},mounted:function(){var t=this;this.initialMap(),this.axios.get("https://raw.githubusercontent.com/kiang/pharmacies/master/json/points.json?fbclid=IwAR0TSsgLIAH10XrE6fFk7bRmXyxXd_FK4NZO39yOkcS28rpVfCkQZJit0Dc").then((function(e){t.dataAry=e.data.features,t.dataAry.forEach((function(e){return t.city.push(e.properties.county)})),t.cityFilter=t.city.filter((function(e,a,r){return t.city.indexOf(e)===a}));var a=t.cityFilter.findIndex((function(t){return""===t}));t.cityFilter.splice(a,1),t.dataAry.forEach((function(e){return t.geoInfo.push({name:e.properties.name,lat:e.geometry.coordinates[0],lng:e.geometry.coordinates[1],adult:e.properties.mask_adult,child:e.properties.mask_child,phone:e.properties.phone})})),t.dataCreated()}))},components:{Card:f}},w=y,_=(a("5c0b"),Object(p["a"])(w,s,n,!1,null,null,null)),k=_.exports,C=a("bc3a"),x=a.n(C),A=a("a7fe"),O=a.n(A),j=a("ebfd"),S=a.n(j),I=a("9062"),P=a.n(I),M=(a("e40d"),a("15f5"),a("7051"),a("5f5b")),L=a("b1e0");r["default"].use(O.a,x.a),r["default"].use(S.a),r["default"].component("Loading",P.a),r["default"].use(M["a"]),r["default"].use(L["a"]),r["default"].config.productionTip=!1,new r["default"]({render:function(t){return t(k)}}).$mount("#app")},"5c0b":function(t,e,a){"use strict";var r=a("9c0c"),s=a.n(r);s.a},"9c0c":function(t,e,a){}});
//# sourceMappingURL=app.3ef29996.js.map